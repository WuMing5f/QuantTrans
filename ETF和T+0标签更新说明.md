# ETF和T+0标签更新说明

## ✅ 已完成的更新

### 1. 新增ETF列表

已添加以下6个ETF到系统：

| ETF代码 | ETF名称 | 行业分类 | 交易规则 |
|---------|---------|---------|---------|
| 513310 | 中韩半导体ETF | 半导体 | T+0 |
| 518880 | 黄金ETF | 贵金属 | T+0 |
| 159502 | 标普生物科技ETF | 生物科技 | T+0 |
| 513100 | 纳指ETF | 海外指数 | T+0 |
| 513120 | 恒生创新药ETF | 医疗 | T+0 |
| 513130 | 恒生科技ETF | 科技 | T+0 |

**说明**：
- 这些ETF都是跨境ETF或特殊ETF，通常支持T+0交易
- 已添加到 `batch_sync` 和 `batch_sync_minute` 命令的ETF列表中

### 2. T+0/T+1交易规则标签

**数据库模型更新**：
- 在 `Instrument` 模型中添加了 `trading_rule` 字段
- 字段类型：`CharField`，可选值：`T+0` 或 `T+1`
- 默认值：`T+1`（大多数A股ETF）

**显示位置**：

1. **首页（index.html）**：
   - 在标的列表中，每个ETF旁边显示T+0/T+1标签
   - 颜色区分：T+0显示为紫色，T+1显示为蓝灰色

2. **ETF概览页面（etf_overview.html）**：
   - 在表格中新增"交易规则"列
   - 显示T+0或T+1标签，颜色区分

3. **图表详情页面（chart.html）**：
   - 在页面标题下方显示交易规则标签
   - 格式：`A股 | T+0 | K线数据与技术指标`

4. **Django Admin**：
   - 在Instrument列表中添加了trading_rule列
   - 可以按交易规则筛选

### 3. 自动设置交易规则

**batch_sync命令**：
- 自动识别跨境ETF和黄金ETF，设置为T+0
- 其他ETF默认设置为T+1
- 同步数据时会自动更新交易规则

**识别规则**：
```python
# T+0 ETF列表
T0_ETFS = ['513310', '518880', '159502', '513100', '513120', '513130']

# 其他ETF默认为T+1
```

## 📊 当前ETF总数

**宽基指数**：7个
**行业ETF**：15个（金融、科技、消费、医疗、传媒、军工等）
**跨境ETF**：6个（新增）

**总计**：28个ETF

## 🔄 数据同步

### 同步新增ETF的日K数据

```bash
# 同步所有ETF（包括新增的）
python manage.py batch_sync --type etf --start 2022-01-01 --end 2025-12-20
```

### 同步新增ETF的分钟数据

```bash
# 同步1分钟数据
python manage.py batch_sync_minute --interval 1m --days 7

# 然后聚合生成5分钟和1小时数据
python manage.py aggregate_minute_data --interval all
```

## 🎨 标签样式

- **T+0标签**：紫色背景（#9C27B0），白色文字
- **T+1标签**：蓝灰色背景（#607D8B），白色文字
- **无标签**：显示"-"（灰色）

## 📝 注意事项

1. **交易规则准确性**：
   - 系统根据ETF类型自动设置，但建议验证
   - 可以在Django Admin中手动修改

2. **数据同步**：
   - 新增的ETF需要先同步数据才能显示
   - 建议先同步日K数据，再同步分钟数据

3. **跨境ETF**：
   - 跨境ETF通常支持T+0交易
   - 但具体规则可能因ETF而异，建议查阅基金说明书

## 🚀 下一步：回测功能

现在数据已经准备就绪，包括：
- ✅ 28个ETF的日K数据
- ✅ 分钟K数据（1分钟、5分钟、1小时）
- ✅ 技术指标计算
- ✅ T+0/T+1标签显示

可以开始实现回测功能了！

